<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>Mister White Game</title>

<style>
:root {
    --bg: #121212;
    --card: #1E1E1E;
    --accent: #00D4A6;
    --text: #EAEAEA;
    --danger: #FF4D4D;
}

body {
    font-family: 'Arial', sans-serif;
    background-color: var(--bg);
    color: var(--text);
    text-align: center;
    margin: 0;
    padding: 20px;
}

h2 {
    color: var(--accent);
    margin-bottom: 10px;
}

input {
    width: 90%;
    padding: 12px;
    border-radius: 10px;
    border: none;
    margin: 10px 0;
    font-size: 18px;
    text-align: center;
}

.card {
    background: var(--card);
    padding: 20px;
    border-radius: 15px;
    max-width: 450px;
    margin: 20px auto;
    box-shadow: 0 0 15px rgba(0, 212, 166, 0.25);
}

button {
    width: 90%;
    max-width: 300px;
    padding: 15px;
    font-size: 18px;
    font-weight: bold;
    margin-top: 15px;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    background-color: var(--accent);
    color: black;
    transition: transform 0.2s, opacity 0.2s;
}

button:active {
    transform: scale(0.95);
    opacity: 0.8;
}

#roleScreen, #intermediateScreen, #finalScreen, #wordManagerScreen {
    display: none;
}

#roleText {
    font-size: 26px;
    margin-top: 20px;
    color: var(--accent);
    font-weight: bold;
}

ul {
    list-style-type: none;
    padding-left: 0;
}

ul li {
    padding: 5px 0;
}
</style>

</head>
<body>

<h2>Mister White Game</h2>

<!-- Schermata iniziale -->
<div class="card" id="setupScreen">
    <p>Inserisci i nomi dei giocatori (separati da virgola):</p>
    <input type="text" id="playerNames" placeholder="Luca, Marco, Giulia...">
    <button onclick="startGame()">üé≤ Inizia la partita</button>
    <button onclick="openWordManager()">üìù Gestisci parole</button>
</div>

<!-- Schermata ruoli -->
<div class="card" id="roleScreen">
    <h3 id="currentPlayer"></h3>
    <button id="showRoleBtn" onclick="showRole()">Mostra ruolo üîç</button>
    <p id="roleText" style="display:none;"></p>
    <button id="nextPlayerBtn" onclick="nextPlayer()" style="display:none;">Giocatore successivo ‚û°Ô∏è</button>
</div>

<!-- Schermata intermedia dopo tutti i ruoli -->
<div class="card" id="intermediateScreen">
    <p>Tutti hanno visto il proprio ruolo!</p>
    <button onclick="showFinalScreen()">‚û°Ô∏è Mostra riepilogo</button>
</div>

<!-- Schermata riepilogo finale -->
<div class="card" id="finalScreen">
    <h3>Riepilogo</h3>
    <p id="summaryText"></p>
    <button onclick="restartGame()">üîÑ Nuova partita</button>
</div>

<!-- Schermata gestione parole -->
<div class="card" id="wordManagerScreen">
    <h3>Lista parole gioco</h3>
    <ul id="wordList"></ul>
    <input type="text" id="newWordInput" placeholder="Nuova parola">
    <button onclick="addWordToList()">‚ûï Aggiungi parola</button>
    <br><br>
    <button onclick="closeWordManager()">Chiudi</button>
</div>

<script>
// --- Variabili globali ---
let players = [];
let misterWhite = "";
let secretWord = "";
let currentIndex = 0;
let savedPlayerNames = "";

// Lista parole default
const defaultWords = [
    "Pizza", "Roma", "Drago", "Acqua", "Aereo",
    "Telefono", "Cinema", "Squalo", "Montagna", "Robot",
    "Gelato", "Torre", "Occhiali", "Luna", "Farfalla"
];

// Carica parole da localStorage o usa default
let randomWords = JSON.parse(localStorage.getItem('gameWords')) || defaultWords.slice();

// --- Funzioni Gestione parole ---
function openWordManager() {
    document.getElementById("setupScreen").style.display = "none";
    document.getElementById("wordManagerScreen").style.display = "block";
    renderWordList();
}

function renderWordList() {
    const ul = document.getElementById("wordList");
    ul.innerHTML = "";
    randomWords.forEach(word => {
        const li = document.createElement("li");
        li.textContent = word;
        ul.appendChild(li);
    });
}

function addWordToList() {
    const newWord = document.getElementById("newWordInput").value.trim();
    if(newWord && !randomWords.includes(newWord)) {
        randomWords.push(newWord);
        localStorage.setItem('gameWords', JSON.stringify(randomWords));
        document.getElementById("newWordInput").value = "";
        renderWordList();
    } else {
        alert("Parola vuota o gi√† presente!");
    }
}

function closeWordManager() {
    document.getElementById("wordManagerScreen").style.display = "none";
    document.getElementById("setupScreen").style.display = "block";
}

// --- Funzioni Gioco ---
function startGame() {
    players = document.getElementById("playerNames")
                .value.split(",")
                .map(p => p.trim())
                .filter(p => p);

    if(players.length < 3) {
        alert("Minimo 3 giocatori!");
        return;
    }

    // salva i nomi per la prossima partita
    savedPlayerNames = players.join(", ");

    // parola segreta casuale
    secretWord = randomWords[Math.floor(Math.random() * randomWords.length)];

    misterWhite = players[Math.floor(Math.random() * players.length)];

    currentIndex = 0;

    document.getElementById("setupScreen").style.display = "none";
    document.getElementById("finalScreen").style.display = "none";
    document.getElementById("intermediateScreen").style.display = "none";
    document.getElementById("roleScreen").style.display = "block";

    updatePlayerScreen();
}

function updatePlayerScreen() {
    document.getElementById("currentPlayer").innerText =
        "Turno di: " + players[currentIndex];

    document.getElementById("roleText").style.display = "none";
    document.getElementById("showRoleBtn").style.display = "block";
    document.getElementById("nextPlayerBtn").style.display = "none";
}

function showRole() {
    let role = (players[currentIndex] === misterWhite)
               ? "‚ùì SEI MISTER WHITE! ‚ùì"
               : "Parola: " + secretWord;

    document.getElementById("roleText").innerText = role;
    document.getElementById("roleText").style.display = "block";
    document.getElementById("showRoleBtn").style.display = "none";
    document.getElementById("nextPlayerBtn").style.display = "block";
}

function nextPlayer() {
    currentIndex++;
    if(currentIndex >= players.length) {
        document.getElementById("roleScreen").style.display = "none";
        document.getElementById("intermediateScreen").style.display = "block";
    } else {
        updatePlayerScreen();
    }
}

function showFinalScreen() {
    document.getElementById("intermediateScreen").style.display = "none";
    document.getElementById("finalScreen").style.display = "block";

    document.getElementById("summaryText").innerHTML =
        `<strong>Mister White:</strong> ${misterWhite}<br><br>` +
        `<strong>Giocatori:</strong><br>${players.join("<br>")}`;
}

function restartGame() {
    // reset variabili
    players = [];
    misterWhite = "";
    secretWord = "";
    currentIndex = 0;

    // reset UI e riporta nomi precedenti
    document.getElementById("playerNames").value = savedPlayerNames;

    document.getElementById("finalScreen").style.display = "none";
    document.getElementById("intermediateScreen").style.display = "none";
    document.getElementById("roleScreen").style.display = "none";
    document.getElementById("setupScreen").style.display = "block";
}
</script>

</body>
</html>
